function cov_1lzd6lg945(){var path="/vagrant/continuum/core/src/modules/evaluation/middlewares/chl/v1/equifax/fn/getResponseFromEquifaxApi.js";var hash="718bccba705b67c967d9639e4c789fa37e03d317";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/vagrant/continuum/core/src/modules/evaluation/middlewares/chl/v1/equifax/fn/getResponseFromEquifaxApi.js",statementMap:{"0":{start:{line:1,column:15},end:{line:1,column:32}},"1":{start:{line:2,column:14},end:{line:2,column:30}},"2":{start:{line:3,column:24},end:{line:3,column:52}},"3":{start:{line:4,column:17},end:{line:4,column:37}},"4":{start:{line:6,column:102},end:{line:6,column:113}},"5":{start:{line:8,column:27},end:{line:27,column:2}},"6":{start:{line:8,column:37},end:{line:27,column:1}},"7":{start:{line:29,column:34},end:{line:49,column:1}},"8":{start:{line:30,column:2},end:{line:32,column:3}},"9":{start:{line:31,column:4},end:{line:31,column:27}},"10":{start:{line:34,column:19},end:{line:42,column:4}},"11":{start:{line:43,column:2},end:{line:48,column:3}},"12":{start:{line:44,column:4},end:{line:44,column:71}},"13":{start:{line:46,column:4},end:{line:46,column:51}},"14":{start:{line:47,column:4},end:{line:47,column:25}},"15":{start:{line:51,column:0},end:{line:53,column:2}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:8,column:27},end:{line:8,column:28}},loc:{start:{line:8,column:37},end:{line:27,column:1}},line:8},"1":{name:"(anonymous_1)",decl:{start:{line:29,column:34},end:{line:29,column:35}},loc:{start:{line:29,column:61},end:{line:49,column:1}},line:29}},branchMap:{"0":{loc:{start:{line:30,column:2},end:{line:32,column:3}},type:"if",locations:[{start:{line:30,column:2},end:{line:32,column:3}},{start:{line:30,column:2},end:{line:32,column:3}}],line:30},"1":{loc:{start:{line:30,column:6},end:{line:30,column:46}},type:"binary-expr",locations:[{start:{line:30,column:6},end:{line:30,column:19}},{start:{line:30,column:23},end:{line:30,column:46}}],line:30},"2":{loc:{start:{line:43,column:2},end:{line:48,column:3}},type:"if",locations:[{start:{line:43,column:2},end:{line:48,column:3}},{start:{line:43,column:2},end:{line:48,column:3}}],line:43}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0},f:{"0":0,"1":0},b:{"0":[0,0],"1":[0,0],"2":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"718bccba705b67c967d9639e4c789fa37e03d317"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1lzd6lg945=function(){return actualCoverage;};}return actualCoverage;}cov_1lzd6lg945();const xml2js=(cov_1lzd6lg945().s[0]++,require('xml2js'));const axios=(cov_1lzd6lg945().s[1]++,require('axios'));const mockApiResponse=(cov_1lzd6lg945().s[2]++,require('./mockApiResponse'));const FormData=(cov_1lzd6lg945().s[3]++,require('form-data'));const{USE_MOCK_DATA,EQUIFAX_CHILE_V1_URL,EQUIFAX_CHILE_V1_CONTENT_TYPE,EQUIFAX_CHILE_V1_AUTH}=(cov_1lzd6lg945().s[4]++,process.env);cov_1lzd6lg945().s[5]++;const prepareRequestBody=rut=>{cov_1lzd6lg945().f[0]++;cov_1lzd6lg945().s[6]++;return{applicants:{primaryConsumer:{personalInformation:{name:[{identifier:'current'}],chileanRut:rut.replace(/\D/g,''),addresses:[{identifier:'Current'}],customerReferenceIdentifier:'AMICAR'}}}};};cov_1lzd6lg945().s[7]++;const getResponseFromEquifaxApi=async customerRequest=>{cov_1lzd6lg945().f[1]++;cov_1lzd6lg945().s[8]++;if((cov_1lzd6lg945().b[1][0]++,USE_MOCK_DATA)&&(cov_1lzd6lg945().b[1][1]++,USE_MOCK_DATA==='YES')){cov_1lzd6lg945().b[0][0]++;cov_1lzd6lg945().s[9]++;return mockApiResponse;}else{cov_1lzd6lg945().b[0][1]++;}const response=(cov_1lzd6lg945().s[10]++,await axios({method:'post',url:EQUIFAX_CHILE_V1_URL,headers:{'Content-Type':EQUIFAX_CHILE_V1_CONTENT_TYPE,Authorization:`Bearer  ${EQUIFAX_CHILE_V1_AUTH}`},data:prepareRequestBody(customerRequest.identifierValue)}));cov_1lzd6lg945().s[11]++;if(response.status!==200){cov_1lzd6lg945().b[2][0]++;cov_1lzd6lg945().s[12]++;throw new Error(`${__dirname}/equifax::getResponseFromApi::ERROR`);}else{cov_1lzd6lg945().b[2][1]++;cov_1lzd6lg945().s[13]++;response.data.equifaxResponseDate=new Date();cov_1lzd6lg945().s[14]++;return response.data;}};cov_1lzd6lg945().s[15]++;module.exports={getResponseFromEquifaxApi};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdldFJlc3BvbnNlRnJvbUVxdWlmYXhBcGkuanMiXSwibmFtZXMiOlsieG1sMmpzIiwicmVxdWlyZSIsImF4aW9zIiwibW9ja0FwaVJlc3BvbnNlIiwiRm9ybURhdGEiLCJVU0VfTU9DS19EQVRBIiwiRVFVSUZBWF9DSElMRV9WMV9VUkwiLCJFUVVJRkFYX0NISUxFX1YxX0NPTlRFTlRfVFlQRSIsIkVRVUlGQVhfQ0hJTEVfVjFfQVVUSCIsInByb2Nlc3MiLCJlbnYiLCJwcmVwYXJlUmVxdWVzdEJvZHkiLCJydXQiLCJhcHBsaWNhbnRzIiwicHJpbWFyeUNvbnN1bWVyIiwicGVyc29uYWxJbmZvcm1hdGlvbiIsIm5hbWUiLCJpZGVudGlmaWVyIiwiY2hpbGVhblJ1dCIsInJlcGxhY2UiLCJhZGRyZXNzZXMiLCJjdXN0b21lclJlZmVyZW5jZUlkZW50aWZpZXIiLCJnZXRSZXNwb25zZUZyb21FcXVpZmF4QXBpIiwiY3VzdG9tZXJSZXF1ZXN0IiwicmVzcG9uc2UiLCJtZXRob2QiLCJ1cmwiLCJoZWFkZXJzIiwiQXV0aG9yaXphdGlvbiIsImRhdGEiLCJpZGVudGlmaWVyVmFsdWUiLCJzdGF0dXMiLCJFcnJvciIsIl9fZGlybmFtZSIsImVxdWlmYXhSZXNwb25zZURhdGUiLCJEYXRlIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Im1pRkFlWTsyRkFmWixLQUFNQSxDQUFBQSxNQUFNLDBCQUFHQyxPQUFPLENBQUMsUUFBRCxDQUFWLENBQVosQ0FDQSxLQUFNQyxDQUFBQSxLQUFLLDBCQUFHRCxPQUFPLENBQUMsT0FBRCxDQUFWLENBQVgsQ0FDQSxLQUFNRSxDQUFBQSxlQUFlLDBCQUFHRixPQUFPLENBQUMsbUJBQUQsQ0FBVixDQUFyQixDQUNBLEtBQU1HLENBQUFBLFFBQVEsMEJBQUdILE9BQU8sQ0FBQyxXQUFELENBQVYsQ0FBZCxDQUVBLEtBQU0sQ0FBRUksYUFBRixDQUFpQkMsb0JBQWpCLENBQXVDQyw2QkFBdkMsQ0FBc0VDLHFCQUF0RSwyQkFBZ0dDLE9BQU8sQ0FBQ0MsR0FBeEcsQ0FBTixDLHdCQUVBLEtBQU1DLENBQUFBLGtCQUFrQixDQUFJQyxHQUFELEVBQVUsd0RBQ25DQyxVQUFVLENBQUUsQ0FDVkMsZUFBZSxDQUFFLENBQ2ZDLG1CQUFtQixDQUFFLENBQ25CQyxJQUFJLENBQUUsQ0FDSixDQUNFQyxVQUFVLENBQUUsU0FEZCxDQURJLENBRGEsQ0FNbkJDLFVBQVUsQ0FBRU4sR0FBRyxDQUFDTyxPQUFKLENBQVksS0FBWixDQUFtQixFQUFuQixDQU5PLENBT25CQyxTQUFTLENBQUUsQ0FDVCxDQUNFSCxVQUFVLENBQUUsU0FEZCxDQURTLENBUFEsQ0FZbkJJLDJCQUEyQixDQUFFLFFBWlYsQ0FETixDQURQLENBRHVCLEVBbUJwQyxDQW5CRCxDLHdCQXFCQSxLQUFNQyxDQUFBQSx5QkFBeUIsQ0FBRyxLQUFPQyxDQUFBQSxlQUFQLEVBQTJCLGlEQUMzRCxHQUFJLDRCQUFBbEIsYUFBYSwrQkFBSUEsYUFBYSxHQUFLLEtBQXRCLENBQWpCLENBQThDLG9EQUM1QyxNQUFPRixDQUFBQSxlQUFQLENBQ0QsQ0FGRCxpQ0FJQSxLQUFNcUIsQ0FBQUEsUUFBUSwyQkFBRyxLQUFNdEIsQ0FBQUEsS0FBSyxDQUFDLENBQzNCdUIsTUFBTSxDQUFFLE1BRG1CLENBRTNCQyxHQUFHLENBQUVwQixvQkFGc0IsQ0FHM0JxQixPQUFPLENBQUUsQ0FDUCxlQUFnQnBCLDZCQURULENBRVBxQixhQUFhLENBQUcsV0FBVXBCLHFCQUFzQixFQUZ6QyxDQUhrQixDQU8zQnFCLElBQUksQ0FBRWxCLGtCQUFrQixDQUFDWSxlQUFlLENBQUNPLGVBQWpCLENBUEcsQ0FBRCxDQUFkLENBQWQsQ0FMMkQseUJBYzNELEdBQUlOLFFBQVEsQ0FBQ08sTUFBVCxHQUFvQixHQUF4QixDQUE2QixxREFDM0IsS0FBTSxJQUFJQyxDQUFBQSxLQUFKLENBQVcsR0FBRUMsU0FBVSxxQ0FBdkIsQ0FBTixDQUNELENBRkQsSUFFTyxxREFDTFQsUUFBUSxDQUFDSyxJQUFULENBQWNLLG1CQUFkLENBQW9DLEdBQUlDLENBQUFBLElBQUosRUFBcEMsQ0FESyx5QkFFTCxNQUFPWCxDQUFBQSxRQUFRLENBQUNLLElBQWhCLENBQ0QsQ0FDRixDQXBCRCxDLHlCQXNCQU8sTUFBTSxDQUFDQyxPQUFQLENBQWlCLENBQ2ZmLHlCQURlLENBQWpCIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgeG1sMmpzID0gcmVxdWlyZSgneG1sMmpzJyk7XHJcbmNvbnN0IGF4aW9zID0gcmVxdWlyZSgnYXhpb3MnKTtcclxuY29uc3QgbW9ja0FwaVJlc3BvbnNlID0gcmVxdWlyZSgnLi9tb2NrQXBpUmVzcG9uc2UnKTtcclxuY29uc3QgRm9ybURhdGEgPSByZXF1aXJlKCdmb3JtLWRhdGEnKTtcclxuXHJcbmNvbnN0IHsgVVNFX01PQ0tfREFUQSwgRVFVSUZBWF9DSElMRV9WMV9VUkwsIEVRVUlGQVhfQ0hJTEVfVjFfQ09OVEVOVF9UWVBFLCBFUVVJRkFYX0NISUxFX1YxX0FVVEggfSA9IHByb2Nlc3MuZW52O1xyXG5cclxuY29uc3QgcHJlcGFyZVJlcXVlc3RCb2R5ID0gKHJ1dCkgPT4gKHtcclxuICBhcHBsaWNhbnRzOiB7XHJcbiAgICBwcmltYXJ5Q29uc3VtZXI6IHtcclxuICAgICAgcGVyc29uYWxJbmZvcm1hdGlvbjoge1xyXG4gICAgICAgIG5hbWU6IFtcclxuICAgICAgICAgIHtcclxuICAgICAgICAgICAgaWRlbnRpZmllcjogJ2N1cnJlbnQnLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICBdLFxyXG4gICAgICAgIGNoaWxlYW5SdXQ6IHJ1dC5yZXBsYWNlKC9cXEQvZywgJycpLFxyXG4gICAgICAgIGFkZHJlc3NlczogW1xyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICBpZGVudGlmaWVyOiAnQ3VycmVudCcsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIF0sXHJcbiAgICAgICAgY3VzdG9tZXJSZWZlcmVuY2VJZGVudGlmaWVyOiAnQU1JQ0FSJyxcclxuICAgICAgfSxcclxuICAgIH0sXHJcbiAgfSxcclxufSk7XHJcblxyXG5jb25zdCBnZXRSZXNwb25zZUZyb21FcXVpZmF4QXBpID0gYXN5bmMgKGN1c3RvbWVyUmVxdWVzdCkgPT4ge1xyXG4gIGlmIChVU0VfTU9DS19EQVRBICYmIFVTRV9NT0NLX0RBVEEgPT09ICdZRVMnKSB7XHJcbiAgICByZXR1cm4gbW9ja0FwaVJlc3BvbnNlO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBheGlvcyh7XHJcbiAgICBtZXRob2Q6ICdwb3N0JyxcclxuICAgIHVybDogRVFVSUZBWF9DSElMRV9WMV9VUkwsXHJcbiAgICBoZWFkZXJzOiB7XHJcbiAgICAgICdDb250ZW50LVR5cGUnOiBFUVVJRkFYX0NISUxFX1YxX0NPTlRFTlRfVFlQRSxcclxuICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAgJHtFUVVJRkFYX0NISUxFX1YxX0FVVEh9YCxcclxuICAgIH0sXHJcbiAgICBkYXRhOiBwcmVwYXJlUmVxdWVzdEJvZHkoY3VzdG9tZXJSZXF1ZXN0LmlkZW50aWZpZXJWYWx1ZSksXHJcbiAgfSk7XHJcbiAgaWYgKHJlc3BvbnNlLnN0YXR1cyAhPT0gMjAwKSB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoYCR7X19kaXJuYW1lfS9lcXVpZmF4OjpnZXRSZXNwb25zZUZyb21BcGk6OkVSUk9SYCk7XHJcbiAgfSBlbHNlIHtcclxuICAgIHJlc3BvbnNlLmRhdGEuZXF1aWZheFJlc3BvbnNlRGF0ZSA9IG5ldyBEYXRlKCk7XHJcbiAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcclxuICB9XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHtcclxuICBnZXRSZXNwb25zZUZyb21FcXVpZmF4QXBpLFxyXG59O1xyXG4iXX0=