function cov_2okkw1i2lk(){var path="/vagrant/continuum/core/src/modules/pre-evaluation/middlewares/default/fn/decisionEngine.js";var hash="ba9e0c70b59c76321a20d65c832a6e34fd0c9479";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/vagrant/continuum/core/src/modules/pre-evaluation/middlewares/default/fn/decisionEngine.js",statementMap:{"0":{start:{line:1,column:19},end:{line:1,column:71}},"1":{start:{line:2,column:23},end:{line:2,column:90}},"2":{start:{line:3,column:15},end:{line:3,column:32}},"3":{start:{line:5,column:24},end:{line:24,column:1}},"4":{start:{line:6,column:2},end:{line:23,column:4}},"5":{start:{line:25,column:28},end:{line:30,column:1}},"6":{start:{line:26,column:2},end:{line:29,column:4}},"7":{start:{line:32,column:23},end:{line:69,column:1}},"8":{start:{line:33,column:33},end:{line:33,column:58}},"9":{start:{line:34,column:22},end:{line:36,column:4}},"10":{start:{line:37,column:2},end:{line:37,column:98}},"11":{start:{line:37,column:20},end:{line:37,column:98}},"12":{start:{line:38,column:20},end:{line:38,column:39}},"13":{start:{line:40,column:25},end:{line:40,column:50}},"14":{start:{line:41,column:18},end:{line:41,column:64}},"15":{start:{line:43,column:15},end:{line:43,column:26}},"16":{start:{line:44,column:22},end:{line:44,column:30}},"17":{start:{line:46,column:18},end:{line:46,column:67}},"18":{start:{line:47,column:16},end:{line:47,column:50}},"19":{start:{line:49,column:21},end:{line:49,column:28}},"20":{start:{line:50,column:17},end:{line:50,column:64}},"21":{start:{line:51,column:17},end:{line:51,column:50}},"22":{start:{line:53,column:2},end:{line:55,column:3}},"23":{start:{line:54,column:4},end:{line:54,column:41}},"24":{start:{line:57,column:2},end:{line:59,column:3}},"25":{start:{line:58,column:4},end:{line:58,column:40}},"26":{start:{line:60,column:2},end:{line:68,column:3}},"27":{start:{line:61,column:23},end:{line:61,column:44}},"28":{start:{line:62,column:22},end:{line:62,column:60}},"29":{start:{line:63,column:4},end:{line:63,column:60}},"30":{start:{line:63,column:24},end:{line:63,column:60}},"31":{start:{line:64,column:4},end:{line:64,column:71}},"32":{start:{line:64,column:51},end:{line:64,column:71}},"33":{start:{line:65,column:4},end:{line:65,column:61}},"34":{start:{line:67,column:4},end:{line:67,column:63}},"35":{start:{line:70,column:0},end:{line:72,column:2}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:5,column:24},end:{line:5,column:25}},loc:{start:{line:5,column:34},end:{line:24,column:1}},line:5},"1":{name:"(anonymous_1)",decl:{start:{line:25,column:28},end:{line:25,column:29}},loc:{start:{line:25,column:38},end:{line:30,column:1}},line:25},"2":{name:"(anonymous_2)",decl:{start:{line:32,column:23},end:{line:32,column:24}},loc:{start:{line:32,column:53},end:{line:69,column:1}},line:32}},branchMap:{"0":{loc:{start:{line:15,column:11},end:{line:15,column:94}},type:"cond-expr",locations:[{start:{line:15,column:54},end:{line:15,column:90}},{start:{line:15,column:93},end:{line:15,column:94}}],line:15},"1":{loc:{start:{line:37,column:2},end:{line:37,column:98}},type:"if",locations:[{start:{line:37,column:2},end:{line:37,column:98}},{start:{line:37,column:2},end:{line:37,column:98}}],line:37},"2":{loc:{start:{line:46,column:25},end:{line:46,column:54}},type:"binary-expr",locations:[{start:{line:46,column:25},end:{line:46,column:38}},{start:{line:46,column:42},end:{line:46,column:54}}],line:46},"3":{loc:{start:{line:53,column:2},end:{line:55,column:3}},type:"if",locations:[{start:{line:53,column:2},end:{line:55,column:3}},{start:{line:53,column:2},end:{line:55,column:3}}],line:53},"4":{loc:{start:{line:53,column:6},end:{line:53,column:36}},type:"binary-expr",locations:[{start:{line:53,column:6},end:{line:53,column:19}},{start:{line:53,column:23},end:{line:53,column:36}}],line:53},"5":{loc:{start:{line:57,column:2},end:{line:59,column:3}},type:"if",locations:[{start:{line:57,column:2},end:{line:59,column:3}},{start:{line:57,column:2},end:{line:59,column:3}}],line:57},"6":{loc:{start:{line:60,column:2},end:{line:68,column:3}},type:"if",locations:[{start:{line:60,column:2},end:{line:68,column:3}},{start:{line:60,column:2},end:{line:68,column:3}}],line:60},"7":{loc:{start:{line:63,column:4},end:{line:63,column:60}},type:"if",locations:[{start:{line:63,column:4},end:{line:63,column:60}},{start:{line:63,column:4},end:{line:63,column:60}}],line:63},"8":{loc:{start:{line:64,column:4},end:{line:64,column:71}},type:"if",locations:[{start:{line:64,column:4},end:{line:64,column:71}},{start:{line:64,column:4},end:{line:64,column:71}}],line:64}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0},f:{"0":0,"1":0,"2":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"ba9e0c70b59c76321a20d65c832a6e34fd0c9479"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_2okkw1i2lk=function(){return actualCoverage;};}return actualCoverage;}cov_2okkw1i2lk();const{getWic}=(cov_2okkw1i2lk().s[0]++,require('modules/evaluation/middlewares/wic/getWic'));const{getEquifax}=(cov_2okkw1i2lk().s[1]++,require('modules/evaluation/middlewares/chl/v1/equifax/getEquifax'));const moment=(cov_2okkw1i2lk().s[2]++,require('moment'));cov_2okkw1i2lk().s[3]++;const buildPayloadWic=body=>{cov_2okkw1i2lk().f[0]++;cov_2okkw1i2lk().s[4]++;return{model_type:'Logit',staging:'PRODUCTION',workType:body.workType,is_new:body.vehicleType.includes('NUEVO'),lightweight:body.vehicleType.includes('LIVIANO'),nationality:body.nationality,term:body.term,vehiclePrice:body.vehiclePrice,total:body.vehiclePrice-body.downPayment>0?(cov_2okkw1i2lk().b[0][0]++,body.vehiclePrice-body.downPayment):(cov_2okkw1i2lk().b[0][1]++,0),downPayment:body.downPayment,income:body.income,tradeInCarValue:body.tradeInCarValue,monthlyPayment:body.monthlyPayment,workEntryDate:body.workEntryDate,//  "workStartDate": "2012-10-10"
workStartDate:moment().format('YYYY-MM-DD')};};cov_2okkw1i2lk().s[5]++;const buildPayloadEquifax=body=>{cov_2okkw1i2lk().f[1]++;cov_2okkw1i2lk().s[6]++;return{identifierType:'RUT',identifierValue:body.rut};};cov_2okkw1i2lk().s[7]++;const decisionEngine=async(dependencies,body)=>{cov_2okkw1i2lk().f[2]++;const{CoreSettingPgModel}=(cov_2okkw1i2lk().s[8]++,dependencies.commonModels);const coreSetting=(cov_2okkw1i2lk().s[9]++,await CoreSettingPgModel.findOne({where:{type:'PREEVALUATION_MAX_VEHICLE_YEARS'}}));cov_2okkw1i2lk().s[10]++;if(!coreSetting){cov_2okkw1i2lk().b[1][0]++;cov_2okkw1i2lk().s[11]++;throw new Error('Core setting for PREEVALUATION_MAX_VEHICLE_YEARS not found');}else{cov_2okkw1i2lk().b[1][1]++;}const{years}=(cov_2okkw1i2lk().s[12]++,coreSetting.setting);const payloadEquifax=(cov_2okkw1i2lk().s[13]++,buildPayloadEquifax(body));const equifax=(cov_2okkw1i2lk().s[14]++,await getEquifax(dependencies,payloadEquifax));//tiene morosidad
let status=(cov_2okkw1i2lk().s[15]++,'RECHAZADO');const currentDate=(cov_2okkw1i2lk().s[16]++,moment());const dateCar=(cov_2okkw1i2lk().s[17]++,moment((cov_2okkw1i2lk().b[2][0]++,body.car_year)||(cov_2okkw1i2lk().b[2][1]++,'0001-01-01'),'YYYYMMDD'));var diffCar=(cov_2okkw1i2lk().s[18]++,currentDate.diff(dateCar,'years'));const{result}=(cov_2okkw1i2lk().s[19]++,equifax);const fecNac=(cov_2okkw1i2lk().s[20]++,moment(result.equifaxReportedDob,'YYYY-MM-DD'));var diffEdad=(cov_2okkw1i2lk().s[21]++,currentDate.diff(fecNac,'years'));cov_2okkw1i2lk().s[22]++;if((cov_2okkw1i2lk().b[4][0]++,diffEdad<20)||(cov_2okkw1i2lk().b[4][1]++,diffEdad>75)){cov_2okkw1i2lk().b[3][0]++;cov_2okkw1i2lk().s[23]++;return{status,diffEdad,equifax};}else{cov_2okkw1i2lk().b[3][1]++;}cov_2okkw1i2lk().s[24]++;if(diffCar>years){cov_2okkw1i2lk().b[5][0]++;cov_2okkw1i2lk().s[25]++;return{status,diffCar,equifax};}else{cov_2okkw1i2lk().b[5][1]++;}cov_2okkw1i2lk().s[26]++;if(equifax.result.getDelinquency==0){cov_2okkw1i2lk().b[6][0]++;const payloadWic=(cov_2okkw1i2lk().s[27]++,buildPayloadWic(body));const resultWic=(cov_2okkw1i2lk().s[28]++,await getWic(dependencies,payloadWic));cov_2okkw1i2lk().s[29]++;if(resultWic.error){cov_2okkw1i2lk().b[7][0]++;cov_2okkw1i2lk().s[30]++;return{result:'NO DISPONIBLE'};}else{cov_2okkw1i2lk().b[7][1]++;}cov_2okkw1i2lk().s[31]++;if(resultWic.resultWicValidate=='APROBADO'){cov_2okkw1i2lk().b[8][0]++;cov_2okkw1i2lk().s[32]++;status='APROBADO';}else{cov_2okkw1i2lk().b[8][1]++;}cov_2okkw1i2lk().s[33]++;return{status,diffCar,diffEdad,equifax,resultWic};}else{cov_2okkw1i2lk().b[6][1]++;cov_2okkw1i2lk().s[34]++;return{result:'RECHAZADO',diffCar,diffEdad,equifax};}};cov_2okkw1i2lk().s[35]++;module.exports={decisionEngine};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRlY2lzaW9uRW5naW5lLmpzIl0sIm5hbWVzIjpbImdldFdpYyIsInJlcXVpcmUiLCJnZXRFcXVpZmF4IiwibW9tZW50IiwiYnVpbGRQYXlsb2FkV2ljIiwiYm9keSIsIm1vZGVsX3R5cGUiLCJzdGFnaW5nIiwid29ya1R5cGUiLCJpc19uZXciLCJ2ZWhpY2xlVHlwZSIsImluY2x1ZGVzIiwibGlnaHR3ZWlnaHQiLCJuYXRpb25hbGl0eSIsInRlcm0iLCJ2ZWhpY2xlUHJpY2UiLCJ0b3RhbCIsImRvd25QYXltZW50IiwiaW5jb21lIiwidHJhZGVJbkNhclZhbHVlIiwibW9udGhseVBheW1lbnQiLCJ3b3JrRW50cnlEYXRlIiwid29ya1N0YXJ0RGF0ZSIsImZvcm1hdCIsImJ1aWxkUGF5bG9hZEVxdWlmYXgiLCJpZGVudGlmaWVyVHlwZSIsImlkZW50aWZpZXJWYWx1ZSIsInJ1dCIsImRlY2lzaW9uRW5naW5lIiwiZGVwZW5kZW5jaWVzIiwiQ29yZVNldHRpbmdQZ01vZGVsIiwiY29tbW9uTW9kZWxzIiwiY29yZVNldHRpbmciLCJmaW5kT25lIiwid2hlcmUiLCJ0eXBlIiwiRXJyb3IiLCJ5ZWFycyIsInNldHRpbmciLCJwYXlsb2FkRXF1aWZheCIsImVxdWlmYXgiLCJzdGF0dXMiLCJjdXJyZW50RGF0ZSIsImRhdGVDYXIiLCJjYXJfeWVhciIsImRpZmZDYXIiLCJkaWZmIiwicmVzdWx0IiwiZmVjTmFjIiwiZXF1aWZheFJlcG9ydGVkRG9iIiwiZGlmZkVkYWQiLCJnZXREZWxpbnF1ZW5jeSIsInBheWxvYWRXaWMiLCJyZXN1bHRXaWMiLCJlcnJvciIsInJlc3VsdFdpY1ZhbGlkYXRlIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IjhtS0FlWTsyRkFmWixLQUFNLENBQUVBLE1BQUYsMkJBQWFDLE9BQU8sQ0FBQywyQ0FBRCxDQUFwQixDQUFOLENBQ0EsS0FBTSxDQUFFQyxVQUFGLDJCQUFpQkQsT0FBTyxDQUFDLDBEQUFELENBQXhCLENBQU4s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VixPQUExQyxDQUFQLENBQ0QsQ0FDRixDQXJDRCxDLHlCQXNDQWdCLE1BQU0sQ0FBQ0MsT0FBUCxDQUFpQixDQUNmN0IsY0FEZSxDQUFqQiIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHsgZ2V0V2ljIH0gPSByZXF1aXJlKCdtb2R1bGVzL2V2YWx1YXRpb24vbWlkZGxld2FyZXMvd2ljL2dldFdpYycpO1xyXG5jb25zdCB7IGdldEVxdWlmYXggfSA9IHJlcXVpcmUoJ21vZHVsZXMvZXZhbHVhdGlvbi9taWRkbGV3YXJlcy9jaGwvdjEvZXF1aWZheC9nZXRFcXVpZmF4Jyk7XHJcbmNvbnN0IG1vbWVudCA9IHJlcXVpcmUoJ21vbWVudCcpO1xyXG5cclxuY29uc3QgYnVpbGRQYXlsb2FkV2ljID0gKGJvZHkpID0+IHtcclxuICByZXR1cm4ge1xyXG4gICAgbW9kZWxfdHlwZTogJ0xvZ2l0JyxcclxuICAgIHN0YWdpbmc6ICdQUk9EVUNUSU9OJyxcclxuICAgIHdvcmtUeXBlOiBib2R5LndvcmtUeXBlLFxyXG4gICAgaXNfbmV3OiBib2R5LnZlaGljbGVUeXBlLmluY2x1ZGVzKCdOVUVWTycpLFxyXG4gICAgbGlnaHR3ZWlnaHQ6IGJvZHkudmVoaWNsZVR5cGUuaW5jbHVkZXMoJ0xJVklBTk8nKSxcclxuICAgIG5hdGlvbmFsaXR5OiBib2R5Lm5hdGlvbmFsaXR5LFxyXG4gICAgdGVybTogYm9keS50ZXJtLFxyXG4gICAgdmVoaWNsZVByaWNlOiBib2R5LnZlaGljbGVQcmljZSxcclxuICAgIHRvdGFsOiBib2R5LnZlaGljbGVQcmljZSAtIGJvZHkuZG93blBheW1lbnQgPiAwID8gYm9keS52ZWhpY2xlUHJpY2UgLSBib2R5LmRvd25QYXltZW50IDogMCxcclxuICAgIGRvd25QYXltZW50OiBib2R5LmRvd25QYXltZW50LFxyXG4gICAgaW5jb21lOiBib2R5LmluY29tZSxcclxuICAgIHRyYWRlSW5DYXJWYWx1ZTogYm9keS50cmFkZUluQ2FyVmFsdWUsXHJcbiAgICBtb250aGx5UGF5bWVudDogYm9keS5tb250aGx5UGF5bWVudCxcclxuICAgIHdvcmtFbnRyeURhdGU6IGJvZHkud29ya0VudHJ5RGF0ZSxcclxuICAgIC8vICBcIndvcmtTdGFydERhdGVcIjogXCIyMDEyLTEwLTEwXCJcclxuICAgIHdvcmtTdGFydERhdGU6IG1vbWVudCgpLmZvcm1hdCgnWVlZWS1NTS1ERCcpLFxyXG4gIH07XHJcbn07XHJcbmNvbnN0IGJ1aWxkUGF5bG9hZEVxdWlmYXggPSAoYm9keSkgPT4ge1xyXG4gIHJldHVybiB7XHJcbiAgICBpZGVudGlmaWVyVHlwZTogJ1JVVCcsXHJcbiAgICBpZGVudGlmaWVyVmFsdWU6IGJvZHkucnV0LFxyXG4gIH07XHJcbn07XHJcblxyXG5jb25zdCBkZWNpc2lvbkVuZ2luZSA9IGFzeW5jIChkZXBlbmRlbmNpZXMsIGJvZHkpID0+IHtcclxuICBjb25zdCB7IENvcmVTZXR0aW5nUGdNb2RlbCB9ID0gZGVwZW5kZW5jaWVzLmNvbW1vbk1vZGVscztcclxuICBjb25zdCBjb3JlU2V0dGluZyA9IGF3YWl0IENvcmVTZXR0aW5nUGdNb2RlbC5maW5kT25lKHtcclxuICAgIHdoZXJlOiB7IHR5cGU6ICdQUkVFVkFMVUFUSU9OX01BWF9WRUhJQ0xFX1lFQVJTJyB9LFxyXG4gIH0pO1xyXG4gIGlmICghY29yZVNldHRpbmcpIHRocm93IG5ldyBFcnJvcignQ29yZSBzZXR0aW5nIGZvciBQUkVFVkFMVUFUSU9OX01BWF9WRUhJQ0xFX1lFQVJTIG5vdCBmb3VuZCcpO1xyXG4gIGNvbnN0IHsgeWVhcnMgfSA9IGNvcmVTZXR0aW5nLnNldHRpbmc7XHJcblxyXG4gIGNvbnN0IHBheWxvYWRFcXVpZmF4ID0gYnVpbGRQYXlsb2FkRXF1aWZheChib2R5KTtcclxuICBjb25zdCBlcXVpZmF4ID0gYXdhaXQgZ2V0RXF1aWZheChkZXBlbmRlbmNpZXMsIHBheWxvYWRFcXVpZmF4KTtcclxuICAvL3RpZW5lIG1vcm9zaWRhZFxyXG4gIGxldCBzdGF0dXMgPSAnUkVDSEFaQURPJztcclxuICBjb25zdCBjdXJyZW50RGF0ZSA9IG1vbWVudCgpO1xyXG5cclxuICBjb25zdCBkYXRlQ2FyID0gbW9tZW50KGJvZHkuY2FyX3llYXIgfHwgJzAwMDEtMDEtMDEnLCAnWVlZWU1NREQnKTtcclxuICB2YXIgZGlmZkNhciA9IGN1cnJlbnREYXRlLmRpZmYoZGF0ZUNhciwgJ3llYXJzJyk7XHJcblxyXG4gIGNvbnN0IHsgcmVzdWx0IH0gPSBlcXVpZmF4O1xyXG4gIGNvbnN0IGZlY05hYyA9IG1vbWVudChyZXN1bHQuZXF1aWZheFJlcG9ydGVkRG9iLCAnWVlZWS1NTS1ERCcpO1xyXG4gIHZhciBkaWZmRWRhZCA9IGN1cnJlbnREYXRlLmRpZmYoZmVjTmFjLCAneWVhcnMnKTtcclxuXHJcbiAgaWYgKGRpZmZFZGFkIDwgMjAgfHwgZGlmZkVkYWQgPiA3NSkge1xyXG4gICAgcmV0dXJuIHsgc3RhdHVzLCBkaWZmRWRhZCwgZXF1aWZheCB9O1xyXG4gIH1cclxuXHJcbiAgaWYgKGRpZmZDYXIgPiB5ZWFycykge1xyXG4gICAgcmV0dXJuIHsgc3RhdHVzLCBkaWZmQ2FyLCBlcXVpZmF4IH07XHJcbiAgfVxyXG4gIGlmIChlcXVpZmF4LnJlc3VsdC5nZXREZWxpbnF1ZW5jeSA9PSAwKSB7XHJcbiAgICBjb25zdCBwYXlsb2FkV2ljID0gYnVpbGRQYXlsb2FkV2ljKGJvZHkpO1xyXG4gICAgY29uc3QgcmVzdWx0V2ljID0gYXdhaXQgZ2V0V2ljKGRlcGVuZGVuY2llcywgcGF5bG9hZFdpYyk7XHJcbiAgICBpZihyZXN1bHRXaWMuZXJyb3IpIHJldHVybiB7IHJlc3VsdDogJ05PIERJU1BPTklCTEUnLCB9O1xyXG4gICAgaWYgKHJlc3VsdFdpYy5yZXN1bHRXaWNWYWxpZGF0ZSA9PSAnQVBST0JBRE8nKSBzdGF0dXMgPSAnQVBST0JBRE8nO1xyXG4gICAgcmV0dXJuIHsgc3RhdHVzLCBkaWZmQ2FyLCBkaWZmRWRhZCwgZXF1aWZheCwgcmVzdWx0V2ljIH07XHJcbiAgfSBlbHNlIHtcclxuICAgIHJldHVybiB7IHJlc3VsdDogJ1JFQ0hBWkFETycsIGRpZmZDYXIsIGRpZmZFZGFkLCBlcXVpZmF4IH07XHJcbiAgfVxyXG59O1xyXG5tb2R1bGUuZXhwb3J0cyA9IHtcclxuICBkZWNpc2lvbkVuZ2luZSxcclxufTtcclxuIl19