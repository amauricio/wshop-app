function cov_1rec1iyqev(){var path="/vagrant/continuum/core/src/common/helpers/getCurrencyValue.js";var hash="f619d54e575e1799645a7c90f8d4cede2ebd0d28";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/vagrant/continuum/core/src/common/helpers/getCurrencyValue.js",statementMap:{"0":{start:{line:1,column:15},end:{line:1,column:32}},"1":{start:{line:2,column:14},end:{line:2,column:30}},"2":{start:{line:4,column:21},end:{line:4,column:46}},"3":{start:{line:6,column:15},end:{line:6,column:66}},"4":{start:{line:8,column:45},end:{line:8,column:56}},"5":{start:{line:11,column:27},end:{line:30,column:1}},"6":{start:{line:12,column:2},end:{line:29,column:3}},"7":{start:{line:13,column:26},end:{line:13,column:63}},"8":{start:{line:14,column:25},end:{line:17,column:6}},"9":{start:{line:18,column:22},end:{line:18,column:23}},"10":{start:{line:19,column:21},end:{line:23,column:6}},"11":{start:{line:20,column:20},end:{line:20,column:69}},"12":{start:{line:21,column:6},end:{line:21,column:52}},"13":{start:{line:21,column:32},end:{line:21,column:52}},"14":{start:{line:22,column:6},end:{line:22,column:83}},"15":{start:{line:24,column:4},end:{line:24,column:81}},"16":{start:{line:25,column:4},end:{line:25,column:23}},"17":{start:{line:27,column:31},end:{line:27,column:109}},"18":{start:{line:28,column:4},end:{line:28,column:36}},"19":{start:{line:32,column:11},end:{line:45,column:1}},"20":{start:{line:33,column:2},end:{line:44,column:3}},"21":{start:{line:34,column:4},end:{line:34,column:76}},"22":{start:{line:34,column:38},end:{line:34,column:76}},"23":{start:{line:35,column:23},end:{line:35,column:61}},"24":{start:{line:36,column:26},end:{line:36,column:100}},"25":{start:{line:37,column:4},end:{line:40,column:5}},"26":{start:{line:38,column:27},end:{line:38,column:63}},"27":{start:{line:39,column:6},end:{line:39,column:26}},"28":{start:{line:41,column:4},end:{line:41,column:31}},"29":{start:{line:43,column:4},end:{line:43,column:33}},"30":{start:{line:48,column:19},end:{line:59,column:1}},"31":{start:{line:49,column:2},end:{line:58,column:3}},"32":{start:{line:50,column:31},end:{line:53,column:6}},"33":{start:{line:54,column:4},end:{line:54,column:78}},"34":{start:{line:54,column:37},end:{line:54,column:78}},"35":{start:{line:55,column:4},end:{line:55,column:36}},"36":{start:{line:57,column:4},end:{line:57,column:33}},"37":{start:{line:61,column:20},end:{line:65,column:1}},"38":{start:{line:67,column:0},end:{line:73,column:2}},"39":{start:{line:68,column:2},end:{line:72,column:3}},"40":{start:{line:69,column:4},end:{line:69,column:88}},"41":{start:{line:71,column:4},end:{line:71,column:33}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:11,column:27},end:{line:11,column:28}},loc:{start:{line:11,column:49},end:{line:30,column:1}},line:11},"1":{name:"(anonymous_1)",decl:{start:{line:19,column:47},end:{line:19,column:48}},loc:{start:{line:19,column:69},end:{line:23,column:5}},line:19},"2":{name:"(anonymous_2)",decl:{start:{line:32,column:11},end:{line:32,column:12}},loc:{start:{line:32,column:56},end:{line:45,column:1}},line:32},"3":{name:"(anonymous_3)",decl:{start:{line:48,column:19},end:{line:48,column:20}},loc:{start:{line:48,column:53},end:{line:59,column:1}},line:48},"4":{name:"(anonymous_4)",decl:{start:{line:67,column:17},end:{line:67,column:18}},loc:{start:{line:67,column:52},end:{line:73,column:1}},line:67}},branchMap:{"0":{loc:{start:{line:21,column:6},end:{line:21,column:52}},type:"if",locations:[{start:{line:21,column:6},end:{line:21,column:52}},{start:{line:21,column:6},end:{line:21,column:52}}],line:21},"1":{loc:{start:{line:34,column:4},end:{line:34,column:76}},type:"if",locations:[{start:{line:34,column:4},end:{line:34,column:76}},{start:{line:34,column:4},end:{line:34,column:76}}],line:34},"2":{loc:{start:{line:37,column:4},end:{line:40,column:5}},type:"if",locations:[{start:{line:37,column:4},end:{line:40,column:5}},{start:{line:37,column:4},end:{line:40,column:5}}],line:37},"3":{loc:{start:{line:54,column:4},end:{line:54,column:78}},type:"if",locations:[{start:{line:54,column:4},end:{line:54,column:78}},{start:{line:54,column:4},end:{line:54,column:78}}],line:54}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"f619d54e575e1799645a7c90f8d4cede2ebd0d28"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1rec1iyqev=function(){return actualCoverage;};}return actualCoverage;}cov_1rec1iyqev();const moment=(cov_1rec1iyqev().s[0]++,require('moment'));const axios=(cov_1rec1iyqev().s[1]++,require('axios'));const exportModels=(cov_1rec1iyqev().s[2]++,require('./exportModels'));const models=(cov_1rec1iyqev().s[3]++,exportModels([__dirname,'..','models'].join('/')));const{SBIF_API_KEY,SBIF_API_BASE_PATH}=(cov_1rec1iyqev().s[4]++,process.env);// ########################## GET UF VALUE ##########################
cov_1rec1iyqev().s[5]++;const _getUFValueFromApi=async dateString=>{cov_1rec1iyqev().f[0]++;cov_1rec1iyqev().s[6]++;try{const[year,month]=(cov_1rec1iyqev().s[7]++,moment().format('YYYY-MM').split('-'));const sbifResponse=(cov_1rec1iyqev().s[8]++,await axios({url:`${SBIF_API_BASE_PATH}/${year}/${month}?apikey=${SBIF_API_KEY}&formato=json`,method:'get'}));let returnValue=(cov_1rec1iyqev().s[9]++,0);const bulkData=(cov_1rec1iyqev().s[10]++,sbifResponse.data.UFs.map(({Valor,Fecha})=>{cov_1rec1iyqev().f[1]++;const value=(cov_1rec1iyqev().s[11]++,+String(Valor).replace('.','').replace(',','.'));cov_1rec1iyqev().s[12]++;if(dateString===Fecha){cov_1rec1iyqev().b[0][0]++;cov_1rec1iyqev().s[13]++;returnValue=value;}else{cov_1rec1iyqev().b[0][1]++;}cov_1rec1iyqev().s[14]++;return{value,dateString:moment(Fecha).format('YYYY-MM-DD'),type:'UF'};}));cov_1rec1iyqev().s[15]++;models.CurrencyValuePgModel.bulkCreate(bulkData,{ignoreDuplicates:true});cov_1rec1iyqev().s[16]++;return returnValue;}catch(err){const lastValueAvailable=(cov_1rec1iyqev().s[17]++,await models.CurrencyValuePgModel.findOne({order:[['dateString','DESC']]}));cov_1rec1iyqev().s[18]++;return lastValueAvailable.value;}};cov_1rec1iyqev().s[19]++;const UF=async({dateValue,currencyType:type})=>{cov_1rec1iyqev().f[2]++;cov_1rec1iyqev().s[20]++;try{cov_1rec1iyqev().s[21]++;if(!moment(dateValue).isValid()){cov_1rec1iyqev().b[1][0]++;cov_1rec1iyqev().s[22]++;throw new Error('Date value invalid');}else{cov_1rec1iyqev().b[1][1]++;}const dateString=(cov_1rec1iyqev().s[23]++,moment(dateValue).format('YYYY-MM-DD'));const currencyValue=(cov_1rec1iyqev().s[24]++,await models.CurrencyValuePgModel.findOne({where:{dateString,type}}));cov_1rec1iyqev().s[25]++;if(currencyValue===null){cov_1rec1iyqev().b[2][0]++;const valueFromApi=(cov_1rec1iyqev().s[26]++,await _getUFValueFromApi(dateString));cov_1rec1iyqev().s[27]++;return valueFromApi;}else{cov_1rec1iyqev().b[2][1]++;}cov_1rec1iyqev().s[28]++;return currencyValue.value;}catch(err){cov_1rec1iyqev().s[29]++;throw new Error(err.message);}};// ########################## END OF GET UF VALUE ##########################
cov_1rec1iyqev().s[30]++;const PROMISSORY=async({currencyType:type})=>{cov_1rec1iyqev().f[3]++;cov_1rec1iyqev().s[31]++;try{const lastValueAvailable=(cov_1rec1iyqev().s[32]++,await models.CurrencyValuePgModel.findOne({where:{type},order:[['dateString','DESC']]}));cov_1rec1iyqev().s[33]++;if(lastValueAvailable===null){cov_1rec1iyqev().b[3][0]++;cov_1rec1iyqev().s[34]++;throw new Error('Promissory not found.');}else{cov_1rec1iyqev().b[3][1]++;}cov_1rec1iyqev().s[35]++;return lastValueAvailable.value;}catch(err){cov_1rec1iyqev().s[36]++;throw new Error(err.message);}};const currencyMap=(cov_1rec1iyqev().s[37]++,{UF,PROMISSORY_MONTHLY:PROMISSORY,PROMISSORY_YEARLY:PROMISSORY});cov_1rec1iyqev().s[38]++;module.exports=async(currencyType,dateValue)=>{cov_1rec1iyqev().f[4]++;cov_1rec1iyqev().s[39]++;try{cov_1rec1iyqev().s[40]++;return currencyMap[String(currencyType).toUpperCase()]({dateValue,currencyType});}catch(err){cov_1rec1iyqev().s[41]++;throw new Error(err.message);}};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdldEN1cnJlbmN5VmFsdWUuanMiXSwibmFtZXMiOlsibW9tZW50IiwicmVxdWlyZSIsImF4aW9zIiwiZXhwb3J0TW9kZWxzIiwibW9kZWxzIiwiX19kaXJuYW1lIiwiam9pbiIsIlNCSUZfQVBJX0tFWSIsIlNCSUZfQVBJX0JBU0VfUEFUSCIsInByb2Nlc3MiLCJlbnYiLCJfZ2V0VUZWYWx1ZUZyb21BcGkiLCJkYXRlU3RyaW5nIiwieWVhciIsIm1vbnRoIiwiZm9ybWF0Iiwic3BsaXQiLCJzYmlmUmVzcG9uc2UiLCJ1cmwiLCJtZXRob2QiLCJyZXR1cm5WYWx1ZSIsImJ1bGtEYXRhIiwiZGF0YSIsIlVGcyIsIm1hcCIsIlZhbG9yIiwiRmVjaGEiLCJ2YWx1ZSIsIlN0cmluZyIsInJlcGxhY2UiLCJ0eXBlIiwiQ3VycmVuY3lWYWx1ZVBnTW9kZWwiLCJidWxrQ3JlYXRlIiwiaWdub3JlRHVwbGljYXRlcyIsImVyciIsImxhc3RWYWx1ZUF2YWlsYWJsZSIsImZpbmRPbmUiLCJvcmRlciIsIlVGIiwiZGF0ZVZhbHVlIiwiY3VycmVuY3lUeXBlIiwiaXNWYWxpZCIsIkVycm9yIiwiY3VycmVuY3lWYWx1ZSIsIndoZXJlIiwidmFsdWVGcm9tQXBpIiwibWVzc2FnZSIsIlBST01JU1NPUlkiLCJjdXJyZW5jeU1hcCIsIlBST01JU1NPUllfTU9OVEhMWSIsIlBST01JU1NPUllfWUVBUkxZIiwibW9kdWxlIiwiZXhwb3J0cyIsInRvVXBwZXJDYXNlIl0sIm1hcHBpbmdzIjoiK3NKQWVZOzJGQWZaLEtBQU1BLENBQUFBLE1BQU0sMEJBQUdDLE9BQU8sQ0FBQyxRQUFELENBQVYsQ0FBWixDQUNBLEtBQU1DLENBQUFBLEtBQUssMEJBQUdELE9BQU8sQ0FBQyxPQUFELENBQVYsQ0FBWCxDQUVBLEtBQU1FLENBQUFBLFlBQVksMEJBQUdGLE9BQU8sQ0FBQyxnQkFBRCxDQUFWLENBQWxCLENBRUEsS0FBTUcsQ0FBQUEsTUFBTSwwQkFBR0QsWUFBWSxDQUFDLENBQUNFLFNB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LFlBQVAsQ0FBcUJELFNBQXJCLEdBQW1DLGtEQUNsRCxHQUFJLDBCQUNGLE1BQU9TLENBQUFBLFdBQVcsQ0FBQ3BCLE1BQU0sQ0FBQ1ksWUFBRCxDQUFOLENBQXFCYSxXQUFyQixFQUFELENBQVgsQ0FBZ0QsQ0FBRWQsU0FBRixDQUFhQyxZQUFiLENBQWhELENBQVAsQ0FDRCxDQUFDLE1BQU9OLEdBQVAsQ0FBWSwwQkFDWixLQUFNLElBQUlRLENBQUFBLEtBQUosQ0FBVVIsR0FBRyxDQUFDWSxPQUFkLENBQU4sQ0FDRCxDQUNGLENBTkQiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBtb21lbnQgPSByZXF1aXJlKCdtb21lbnQnKTtcclxuY29uc3QgYXhpb3MgPSByZXF1aXJlKCdheGlvcycpO1xyXG5cclxuY29uc3QgZXhwb3J0TW9kZWxzID0gcmVxdWlyZSgnLi9leHBvcnRNb2RlbHMnKTtcclxuXHJcbmNvbnN0IG1vZGVscyA9IGV4cG9ydE1vZGVscyhbX19kaXJuYW1lLCAnLi4nLCAnbW9kZWxzJ10uam9pbignLycpKTtcclxuXHJcbmNvbnN0IHsgU0JJRl9BUElfS0VZLCBTQklGX0FQSV9CQVNFX1BBVEggfSA9IHByb2Nlc3MuZW52O1xyXG5cclxuLy8gIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMgR0VUIFVGIFZBTFVFICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjXHJcbmNvbnN0IF9nZXRVRlZhbHVlRnJvbUFwaSA9IGFzeW5jIChkYXRlU3RyaW5nKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IFt5ZWFyLCBtb250aF0gPSBtb21lbnQoKS5mb3JtYXQoJ1lZWVktTU0nKS5zcGxpdCgnLScpO1xyXG4gICAgY29uc3Qgc2JpZlJlc3BvbnNlID0gYXdhaXQgYXhpb3Moe1xyXG4gICAgICB1cmw6IGAke1NCSUZfQVBJX0JBU0VfUEFUSH0vJHt5ZWFyfS8ke21vbnRofT9hcGlrZXk9JHtTQklGX0FQSV9LRVl9JmZvcm1hdG89anNvbmAsXHJcbiAgICAgIG1ldGhvZDogJ2dldCcsXHJcbiAgICB9KTtcclxuICAgIGxldCByZXR1cm5WYWx1ZSA9IDA7XHJcbiAgICBjb25zdCBidWxrRGF0YSA9IHNiaWZSZXNwb25zZS5kYXRhLlVGcy5tYXAoKHsgVmFsb3IsIEZlY2hhIH0pID0+IHtcclxuICAgICAgY29uc3QgdmFsdWUgPSArU3RyaW5nKFZhbG9yKS5yZXBsYWNlKCcuJywgJycpLnJlcGxhY2UoJywnLCAnLicpO1xyXG4gICAgICBpZiAoZGF0ZVN0cmluZyA9PT0gRmVjaGEpIHJldHVyblZhbHVlID0gdmFsdWU7XHJcbiAgICAgIHJldHVybiB7IHZhbHVlLCBkYXRlU3RyaW5nOiBtb21lbnQoRmVjaGEpLmZvcm1hdCgnWVlZWS1NTS1ERCcpLCB0eXBlOiAnVUYnIH07XHJcbiAgICB9KTtcclxuICAgIG1vZGVscy5DdXJyZW5jeVZhbHVlUGdNb2RlbC5idWxrQ3JlYXRlKGJ1bGtEYXRhLCB7IGlnbm9yZUR1cGxpY2F0ZXM6IHRydWUgfSk7XHJcbiAgICByZXR1cm4gcmV0dXJuVmFsdWU7XHJcbiAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICBjb25zdCBsYXN0VmFsdWVBdmFpbGFibGUgPSBhd2FpdCBtb2RlbHMuQ3VycmVuY3lWYWx1ZVBnTW9kZWwuZmluZE9uZSh7IG9yZGVyOiBbWydkYXRlU3RyaW5nJywgJ0RFU0MnXV0gfSk7XHJcbiAgICByZXR1cm4gbGFzdFZhbHVlQXZhaWxhYmxlLnZhbHVlO1xyXG4gIH1cclxufTtcclxuXHJcbmNvbnN0IFVGID0gYXN5bmMgKHsgZGF0ZVZhbHVlLCBjdXJyZW5jeVR5cGU6IHR5cGUgfSkgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBpZiAoIW1vbWVudChkYXRlVmFsdWUpLmlzVmFsaWQoKSkgdGhyb3cgbmV3IEVycm9yKCdEYXRlIHZhbHVlIGludmFsaWQnKTtcclxuICAgIGNvbnN0IGRhdGVTdHJpbmcgPSBtb21lbnQoZGF0ZVZhbHVlKS5mb3JtYXQoJ1lZWVktTU0tREQnKTtcclxuICAgIGNvbnN0IGN1cnJlbmN5VmFsdWUgPSBhd2FpdCBtb2RlbHMuQ3VycmVuY3lWYWx1ZVBnTW9kZWwuZmluZE9uZSh7IHdoZXJlOiB7IGRhdGVTdHJpbmcsIHR5cGUgfSB9KTtcclxuICAgIGlmIChjdXJyZW5jeVZhbHVlID09PSBudWxsKSB7XHJcbiAgICAgIGNvbnN0IHZhbHVlRnJvbUFwaSA9IGF3YWl0IF9nZXRVRlZhbHVlRnJvbUFwaShkYXRlU3RyaW5nKTtcclxuICAgICAgcmV0dXJuIHZhbHVlRnJvbUFwaTtcclxuICAgIH1cclxuICAgIHJldHVybiBjdXJyZW5jeVZhbHVlLnZhbHVlO1xyXG4gIH0gY2F0Y2ggKGVycikge1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKGVyci5tZXNzYWdlKTtcclxuICB9XHJcbn07XHJcbi8vICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIEVORCBPRiBHRVQgVUYgVkFMVUUgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyNcclxuXHJcbmNvbnN0IFBST01JU1NPUlkgPSBhc3luYyAoeyBjdXJyZW5jeVR5cGU6IHR5cGUgfSkgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBsYXN0VmFsdWVBdmFpbGFibGUgPSBhd2FpdCBtb2RlbHMuQ3VycmVuY3lWYWx1ZVBnTW9kZWwuZmluZE9uZSh7XHJcbiAgICAgIHdoZXJlOiB7IHR5cGUgfSxcclxuICAgICAgb3JkZXI6IFtbJ2RhdGVTdHJpbmcnLCAnREVTQyddXSxcclxuICAgIH0pO1xyXG4gICAgaWYgKGxhc3RWYWx1ZUF2YWlsYWJsZSA9PT0gbnVsbCkgdGhyb3cgbmV3IEVycm9yKCdQcm9taXNzb3J5IG5vdCBmb3VuZC4nKTtcclxuICAgIHJldHVybiBsYXN0VmFsdWVBdmFpbGFibGUudmFsdWU7XHJcbiAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoZXJyLm1lc3NhZ2UpO1xyXG4gIH1cclxufTtcclxuXHJcbmNvbnN0IGN1cnJlbmN5TWFwID0ge1xyXG4gIFVGLFxyXG4gIFBST01JU1NPUllfTU9OVEhMWTogUFJPTUlTU09SWSxcclxuICBQUk9NSVNTT1JZX1lFQVJMWTogUFJPTUlTU09SWSxcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gYXN5bmMgKGN1cnJlbmN5VHlwZSwgZGF0ZVZhbHVlKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIHJldHVybiBjdXJyZW5jeU1hcFtTdHJpbmcoY3VycmVuY3lUeXBlKS50b1VwcGVyQ2FzZSgpXSh7IGRhdGVWYWx1ZSwgY3VycmVuY3lUeXBlIH0pO1xyXG4gIH0gY2F0Y2ggKGVycikge1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKGVyci5tZXNzYWdlKTtcclxuICB9XHJcbn07XHJcbiJdfQ==