function cov_1jpwt5idut(){var path="/vagrant/continuum/core/src/modules/evaluation/middlewares/chl/v2/equifax/fn/getResponseFromEquifaxApi.js";var hash="6090c1ae24d03d3594bb99e07e717bfefeb2a603";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/vagrant/continuum/core/src/modules/evaluation/middlewares/chl/v2/equifax/fn/getResponseFromEquifaxApi.js",statementMap:{"0":{start:{line:1,column:15},end:{line:1,column:32}},"1":{start:{line:2,column:14},end:{line:2,column:30}},"2":{start:{line:3,column:24},end:{line:3,column:52}},"3":{start:{line:14,column:4},end:{line:14,column:15}},"4":{start:{line:17,column:27},end:{line:36,column:4}},"5":{start:{line:17,column:37},end:{line:36,column:3}},"6":{start:{line:39,column:34},end:{line:80,column:3}},"7":{start:{line:40,column:4},end:{line:40,column:32}},"8":{start:{line:41,column:4},end:{line:43,column:5}},"9":{start:{line:42,column:6},end:{line:42,column:29}},"10":{start:{line:45,column:21},end:{line:45,column:35}},"11":{start:{line:46,column:4},end:{line:46,column:62}},"12":{start:{line:47,column:4},end:{line:47,column:62}},"13":{start:{line:48,column:4},end:{line:48,column:66}},"14":{start:{line:49,column:4},end:{line:49,column:56}},"15":{start:{line:51,column:18},end:{line:62,column:6}},"16":{start:{line:64,column:21},end:{line:72,column:6}},"17":{start:{line:74,column:4},end:{line:79,column:5}},"18":{start:{line:75,column:6},end:{line:75,column:73}},"19":{start:{line:77,column:6},end:{line:77,column:53}},"20":{start:{line:78,column:6},end:{line:78,column:22}},"21":{start:{line:82,column:0},end:{line:84,column:1}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:17,column:27},end:{line:17,column:28}},loc:{start:{line:17,column:37},end:{line:36,column:3}},line:17},"1":{name:"(anonymous_1)",decl:{start:{line:39,column:34},end:{line:39,column:35}},loc:{start:{line:39,column:61},end:{line:80,column:3}},line:39}},branchMap:{"0":{loc:{start:{line:41,column:4},end:{line:43,column:5}},type:"if",locations:[{start:{line:41,column:4},end:{line:43,column:5}},{start:{line:41,column:4},end:{line:43,column:5}}],line:41},"1":{loc:{start:{line:41,column:8},end:{line:41,column:48}},type:"binary-expr",locations:[{start:{line:41,column:8},end:{line:41,column:21}},{start:{line:41,column:25},end:{line:41,column:48}}],line:41},"2":{loc:{start:{line:74,column:4},end:{line:79,column:5}},type:"if",locations:[{start:{line:74,column:4},end:{line:79,column:5}},{start:{line:74,column:4},end:{line:79,column:5}}],line:74}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0},f:{"0":0,"1":0},b:{"0":[0,0],"1":[0,0],"2":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"6090c1ae24d03d3594bb99e07e717bfefeb2a603"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1jpwt5idut=function(){return actualCoverage;};}return actualCoverage;}cov_1jpwt5idut();const xml2js=(cov_1jpwt5idut().s[0]++,require('xml2js'));const axios=(cov_1jpwt5idut().s[1]++,require('axios'));const mockApiResponse=(cov_1jpwt5idut().s[2]++,require('./mockApiResponse'));const{USE_MOCK_DATA,EQUIFAX_TOKEN_URL,EQUIFAX_TOKEN_AUTH_USER,EQUIFAX_TOKEN_AUTH_PASSWORD,EQUIFAX_EVALUATION_URL,EQUIFAX_TOKEN_PARAM_USERNAME,EQUIFAX_TOKEN_PARAM_PASSWORD,EQUIFAX_TOKEN_PARAM_GRANT_TYPE,EQUIFAX_TOKEN_PARAM_SCOPE}=(cov_1jpwt5idut().s[3]++,process.env);cov_1jpwt5idut().s[4]++;const prepareRequestBody=rut=>{cov_1jpwt5idut().f[0]++;cov_1jpwt5idut().s[5]++;return{applicants:{primaryConsumer:{personalInformation:{name:[{identifier:'current'}],chileanRut:rut,addresses:[{identifier:'Current'}],customerReferenceIdentifier:'AMICAR'}}}};};cov_1jpwt5idut().s[6]++;const getResponseFromEquifaxApi=async customerRequest=>{cov_1jpwt5idut().f[1]++;cov_1jpwt5idut().s[7]++;console.log(mockApiResponse);cov_1jpwt5idut().s[8]++;if((cov_1jpwt5idut().b[1][0]++,USE_MOCK_DATA)&&(cov_1jpwt5idut().b[1][1]++,USE_MOCK_DATA==='YES')){cov_1jpwt5idut().b[0][0]++;cov_1jpwt5idut().s[9]++;return mockApiResponse;}else{cov_1jpwt5idut().b[0][1]++;}const formData=(cov_1jpwt5idut().s[10]++,new FormData());cov_1jpwt5idut().s[11]++;formData.append('username',EQUIFAX_TOKEN_PARAM_USERNAME);cov_1jpwt5idut().s[12]++;formData.append('password',EQUIFAX_TOKEN_PARAM_PASSWORD);cov_1jpwt5idut().s[13]++;formData.append('grant_type',EQUIFAX_TOKEN_PARAM_GRANT_TYPE);cov_1jpwt5idut().s[14]++;formData.append('scope',EQUIFAX_TOKEN_PARAM_SCOPE);const token=(cov_1jpwt5idut().s[15]++,await axios({method:'post',url:EQUIFAX_TOKEN_URL,headers:{'content-type':`multipart/form-data; boundary=${formData._boundary}`},data:formData,auth:{username:EQUIFAX_TOKEN_AUTH_USER,password:EQUIFAX_TOKEN_AUTH_PASSWORD}}));const response=(cov_1jpwt5idut().s[16]++,await axios({method:'post',url:EQUIFAX_EVALUATION_URL,headers:{'Content-Type':'application/vnd.com.equifax.clientConfig.v1+json',Authorization:`Bearer ${token.data.access_token}`},data:prepareRequestBody(customerRequest.rut)}));cov_1jpwt5idut().s[17]++;if(response.status!==200){cov_1jpwt5idut().b[2][0]++;cov_1jpwt5idut().s[18]++;throw new Error(`${__dirname}/equifax::getResponseFromApi::ERROR`);}else{cov_1jpwt5idut().b[2][1]++;cov_1jpwt5idut().s[19]++;response.data.equifaxResponseDate=new Date();cov_1jpwt5idut().s[20]++;return response;}};cov_1jpwt5idut().s[21]++;module.exports={getResponseFromEquifaxApi};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdldFJlc3BvbnNlRnJvbUVxdWlmYXhBcGkuanMiXSwibmFtZXMiOlsieG1sMmpzIiwicmVxdWlyZSIsImF4aW9zIiwibW9ja0FwaVJlc3BvbnNlIiwiVVNFX01PQ0tfREFUQSIsIkVRVUlGQVhfVE9LRU5fVVJMIiwiRVFVSUZBWF9UT0tFTl9BVVRIX1VTRVIiLCJFUVVJRkFYX1RPS0VOX0FVVEhfUEFTU1dPUkQiLCJFUVVJRkFYX0VWQUxVQVRJT05fVVJMIiwiRVFVSUZBWF9UT0tFTl9QQVJBTV9VU0VSTkFNRSIsIkVRVUlGQVhfVE9LRU5fUEFSQU1fUEFTU1dPUkQiLCJFUVVJRkFYX1RPS0VOX1BBUkFNX0dSQU5UX1RZUEUiLCJFUVVJRkFYX1RPS0VOX1BBUkFNX1NDT1BFIiwicHJvY2VzcyIsImVudiIsInByZXBhcmVSZXF1ZXN0Qm9keSIsInJ1dCIsImFwcGxpY2FudHMiLCJwcmltYXJ5Q29uc3VtZXIiLCJwZXJzb25hbEluZm9ybWF0aW9uIiwibmFtZSIsImlkZW50aWZpZXIiLCJjaGlsZWFuUnV0IiwiYWRkcmVzc2VzIiwiY3VzdG9tZXJSZWZlcmVuY2VJZGVudGlmaWVyIiwiZ2V0UmVzcG9uc2VGcm9tRXF1aWZheEFwaSIsImN1c3RvbWVyUmVxdWVzdCIsImNvbnNvbGUiLCJsb2ciLCJmb3JtRGF0YSIsIkZvcm1EYXRhIiwiYXBwZW5kIiwidG9rZW4iLCJtZXRob2QiLCJ1cmwiLCJoZWFkZXJzIiwiX2JvdW5kYXJ5IiwiZGF0YSIsImF1dGgiLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwicmVzcG9uc2UiLCJBdXRob3JpemF0aW9uIiwiYWNjZXNzX3Rva2VuIiwic3RhdHVzIiwiRXJyb3IiLCJfX2Rpcm5hbWUiLCJlcXVpZmF4UmVzcG9uc2VEYXRlIiwiRGF0ZSIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiJvNkZBZVk7MkZBZlosS0FBTUEsQ0FBQUEsTUFBTSwwQkFBR0MsT0FBTyxDQUFDLFFBQUQsQ0FBVixDQUFaLENBQ0EsS0FBTUMs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LE9BQVAsQ0FBaUIsQ0FDYnpCLHlCQURhLENBQWpCIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgeG1sMmpzID0gcmVxdWlyZSgneG1sMmpzJyk7XHJcbmNvbnN0IGF4aW9zID0gcmVxdWlyZSgnYXhpb3MnKTtcclxuY29uc3QgbW9ja0FwaVJlc3BvbnNlID0gcmVxdWlyZSgnLi9tb2NrQXBpUmVzcG9uc2UnKTtcclxuXHJcbmNvbnN0IHsgVVNFX01PQ0tfREFUQSxcclxuICAgIEVRVUlGQVhfVE9LRU5fVVJMLFxyXG4gICAgRVFVSUZBWF9UT0tFTl9BVVRIX1VTRVIsXHJcbiAgICBFUVVJRkFYX1RPS0VOX0FVVEhfUEFTU1dPUkQsXHJcbiAgICBFUVVJRkFYX0VWQUxVQVRJT05fVVJMLFxyXG4gICAgRVFVSUZBWF9UT0tFTl9QQVJBTV9VU0VSTkFNRSxcclxuICAgIEVRVUlGQVhfVE9LRU5fUEFSQU1fUEFTU1dPUkQsXHJcbiAgICBFUVVJRkFYX1RPS0VOX1BBUkFNX0dSQU5UX1RZUEUsXHJcbiAgICBFUVVJRkFYX1RPS0VOX1BBUkFNX1NDT1BFXHJcbn0gPSBwcm9jZXNzLmVudjtcclxuXHJcblxyXG5jb25zdCBwcmVwYXJlUmVxdWVzdEJvZHkgPSAocnV0KSA9PiAoe1xyXG4gICAgYXBwbGljYW50czoge1xyXG4gICAgICBwcmltYXJ5Q29uc3VtZXI6IHtcclxuICAgICAgICBwZXJzb25hbEluZm9ybWF0aW9uOiB7XHJcbiAgICAgICAgICBuYW1lOiBbXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICBpZGVudGlmaWVyOiAnY3VycmVudCcsXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICBdLFxyXG4gICAgICAgICAgY2hpbGVhblJ1dDogcnV0LFxyXG4gICAgICAgICAgYWRkcmVzc2VzOiBbXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICBpZGVudGlmaWVyOiAnQ3VycmVudCcsXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICBdLFxyXG4gICAgICAgICAgY3VzdG9tZXJSZWZlcmVuY2VJZGVudGlmaWVyOiAnQU1JQ0FSJyxcclxuICAgICAgICB9LFxyXG4gICAgICB9LFxyXG4gICAgfSxcclxuICB9KTtcclxuXHJcbiAgXHJcbmNvbnN0IGdldFJlc3BvbnNlRnJvbUVxdWlmYXhBcGkgPSBhc3luYyAoY3VzdG9tZXJSZXF1ZXN0KSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZyhtb2NrQXBpUmVzcG9uc2UpXHJcbiAgICBpZiAoVVNFX01PQ0tfREFUQSAmJiBVU0VfTU9DS19EQVRBID09PSAnWUVTJykge1xyXG4gICAgICByZXR1cm4gbW9ja0FwaVJlc3BvbnNlO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgY29uc3QgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTtcclxuICAgIGZvcm1EYXRhLmFwcGVuZCgndXNlcm5hbWUnLCBFUVVJRkFYX1RPS0VOX1BBUkFNX1VTRVJOQU1FKTtcclxuICAgIGZvcm1EYXRhLmFwcGVuZCgncGFzc3dvcmQnLCBFUVVJRkFYX1RPS0VOX1BBUkFNX1BBU1NXT1JEKTtcclxuICAgIGZvcm1EYXRhLmFwcGVuZCgnZ3JhbnRfdHlwZScsIEVRVUlGQVhfVE9LRU5fUEFSQU1fR1JBTlRfVFlQRSk7XHJcbiAgICBmb3JtRGF0YS5hcHBlbmQoJ3Njb3BlJywgRVFVSUZBWF9UT0tFTl9QQVJBTV9TQ09QRSk7XHJcbiAgXHJcbiAgICBjb25zdCB0b2tlbiA9IGF3YWl0IGF4aW9zKHtcclxuICAgICAgbWV0aG9kOiAncG9zdCcsXHJcbiAgICAgIHVybDogRVFVSUZBWF9UT0tFTl9VUkwsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAnY29udGVudC10eXBlJzogYG11bHRpcGFydC9mb3JtLWRhdGE7IGJvdW5kYXJ5PSR7Zm9ybURhdGEuX2JvdW5kYXJ5fWAsXHJcbiAgICAgIH0sXHJcbiAgICAgIGRhdGE6IGZvcm1EYXRhLFxyXG4gICAgICBhdXRoOiB7XHJcbiAgICAgICAgdXNlcm5hbWU6IEVRVUlGQVhfVE9LRU5fQVVUSF9VU0VSLFxyXG4gICAgICAgIHBhc3N3b3JkOiBFUVVJRkFYX1RPS0VOX0FVVEhfUEFTU1dPUkQsXHJcbiAgICAgIH0sXHJcbiAgICB9KTtcclxuICBcclxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXhpb3Moe1xyXG4gICAgICBtZXRob2Q6ICdwb3N0JyxcclxuICAgICAgdXJsOiBFUVVJRkFYX0VWQUxVQVRJT05fVVJMLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi92bmQuY29tLmVxdWlmYXguY2xpZW50Q29uZmlnLnYxK2pzb24nLFxyXG4gICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0b2tlbi5kYXRhLmFjY2Vzc190b2tlbn1gLFxyXG4gICAgICB9LFxyXG4gICAgICBkYXRhOiBwcmVwYXJlUmVxdWVzdEJvZHkoY3VzdG9tZXJSZXF1ZXN0LnJ1dCksXHJcbiAgICB9KTtcclxuICBcclxuICAgIGlmIChyZXNwb25zZS5zdGF0dXMgIT09IDIwMCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7X19kaXJuYW1lfS9lcXVpZmF4OjpnZXRSZXNwb25zZUZyb21BcGk6OkVSUk9SYCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXNwb25zZS5kYXRhLmVxdWlmYXhSZXNwb25zZURhdGUgPSBuZXcgRGF0ZSgpO1xyXG4gICAgICByZXR1cm4gcmVzcG9uc2U7XHJcbiAgICB9XHJcbiAgfTtcclxuICBcclxubW9kdWxlLmV4cG9ydHMgPSB7XHJcbiAgICBnZXRSZXNwb25zZUZyb21FcXVpZmF4QXBpXHJcbn1cclxuICAiXX0=